DROP TABLE IF EXISTS USERREQUEST;
DROP TABLE IF EXISTS USERACTION;
DROP TABLE IF EXISTS USER;

CREATE TABLE IF NOT EXISTS USER (
  USERID    INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 100, INCREMENT BY 1) NOT NULL,
  ROLEID    INTEGER      NOT NULL,
  MANAGERID INTEGER      NOT NULL,
  USERNAME  VARCHAR(255) NOT NULL,
  LOGIN     VARCHAR(255) NOT NULL,
  PASSWORD  VARCHAR(255) NOT NULL,
  DELETED   BOOLEAN      NOT NULL,
  BONUS     INTEGER      NOT NULL,
  PRIMARY KEY (USERID)
);

CREATE TABLE IF NOT EXISTS USERACTION (
  ACTIONID   INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 100, INCREMENT BY 1) NOT NULL,
  USERID     INTEGER      NOT NULL,
  ACTIONDATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  ACTIONTYPE INTEGER      NOT NULL,
  ACTIONNAME VARCHAR(255) NOT NULL,
  PRIMARY KEY (ACTIONID),
  FOREIGN KEY (USERID) REFERENCES USER (USERID)
);

CREATE TABLE IF NOT EXISTS USERREQUEST (
  REQUESTID   INTEGER GENERATED BY DEFAULT AS IDENTITY (START WITH 100, INCREMENT BY 1) NOT NULL,
  REQUESTNAME VARCHAR(255) NOT NULL,
  REQUESTSUM  INTEGER      NOT NULL,
  MANAGERID   INTEGER      NOT NULL,
  MANAGERNAME VARCHAR(255) NOT NULL,
  USERID      INTEGER      NOT NULL,
  STATUSID    INTEGER      NOT NULL,
  STATUSNAME  VARCHAR(255) NOT NULL,
  STARTDATE   TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  UPDATEDATE  TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  TEXTREQUEST CLOB(1000),
  PRIMARY KEY (REQUESTID),
  FOREIGN KEY (USERID) REFERENCES USER (USERID),
  FOREIGN KEY (MANAGERID) REFERENCES USER (USERID)
);